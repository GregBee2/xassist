/**
* @preserve
* https://github.com/GregBee2/xassist#readme Version 1.0.2.
*  Copyright 2018 Gregory Beirens.
*  Created on Fri, 13 Apr 2018 10:55:01 GMT.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.xa=e.xa||{})}(this,function(e){"use strict";var n,t="1.0.2",r=Math.round(1e6*Math.random()),i=[],o=!1;function x(e){return{pushUnique:function(e,t,n){return(n=void 0===n||!!n)&&-1!==e.indexOf(t)?e.length:e.push(t)}.bind(null,e),groupSequence:function(e,i){return e.reduce(function(e,t,n,r){return n&&i(r[n-1],t)?e[e.length-1].push(t):e.push([t]),e},[])}.bind(null,e),replaceNull:function(e,n){var t,r=[];t=Array.isArray(n)?function(e,t){return n[t]}:"function"==typeof n?n:function(){return n};for(var i,o=0,s=e.length;o<s;o++)null==(i=e[o])?r.push(t(i,o)):r.push(i);return r}.bind(null,e)}}function s(){if(!(this instanceof s))return new s;this._events={}}function u(e){if(!(this instanceof u))return new u;this._parent=e,this._events={}}function l(e){return new c(e)}function c(e){this.object=e,u.call(this,this),this.currentValues={}}"undefined"!=typeof document&&document.addEventListener("DOMContentLoaded",function(){n=arguments[0],i.forEach(function(e){e[0].call(e[1],n)}),i=[],o=!0},{once:!0}),s.prototype.registerEvent=function(e,t){if(this.hasEvent(e))throw new ReferenceError("event was allready registered");this._events[e]={thisArg:t||this,listeners:[]}},s.prototype.hasEvent=function(e){return this._events.hasOwnProperty(e)},s.prototype.on=function(e,t,n){var r={fn:t};n&&n!==this._events[e].thisArg&&(r.thisArg=n),this.hasEvent(e)&&this._events[e].listeners.push(r)},s.prototype.once=function(e,t,n){var r={fn:t,once:!0};n&&n!==this._events[e].thisArg&&(r.thisArg=n),this.hasEvent(e)&&this._events[e].listeners.push(r)},s.prototype.fire=function(e){var t,n=Array.prototype.slice.call(arguments,1);if(this.hasEvent(e)){t=this._events[e].thisArg;for(var r=0,i=this._events[e].listeners.length;r<i;r+=1)this._events[e].listeners[r].fn.apply(this._events[e].listeners[r].thisArg||t,n);this._events[e].listeners=this._events[e].listeners.filter(function(e){return!e.once})}},s.prototype.off=function(e,t){this.hasEvent(e)&&(this._events[e].listeners=this._events[e].listeners.filter(function(e){return e.fn!==t}))},u.prototype.registerEvent=function(e,t){if(this.hasEvent(e))throw new ReferenceError("event was allready registered");this._events[e]={thisArg:t||this._parent,listeners:[]}},u.prototype.hasEvent=function(e){return this._events.hasOwnProperty(e)},u.prototype.on=function(e,t,n){var r={fn:t};n&&n!==this._events[e].thisArg&&(r.thisArg=n),this.hasEvent(e)&&this._events[e].listeners.push(r)},u.prototype.once=function(e,t,n){var r={fn:t,once:!0};n&&n!==this._events[e].thisArg&&(r.thisArg=n),this.hasEvent(e)&&this._events[e].listeners.push(r)},u.prototype.fire=function(e){var t,n=Array.prototype.slice.call(arguments,1);if(this.hasEvent(e)){t=this._events[e].thisArg;for(var r=0,i=this._events[e].listeners.length;r<i;r+=1)this._events[e].listeners[r].fn.apply(this._events[e].listeners[r].thisArg||t,n);this._events[e].listeners=this._events[e].listeners.filter(function(e){return!e.once})}},u.prototype.off=function(e,t){this.hasEvent(e)&&(this._events[e].listeners=this._events[e].listeners.filter(function(e){return e.fn!==t}))},((c.prototype=Object.create(u.prototype)).constructor=c).prototype.onChange=function(n,e,t){var r=this,i=!1;if(!n||!this.object.hasOwnProperty(n))throw new ReferenceError("key does not exist in Object");this.hasEvent("changeKey"+n)||(this.registerEvent("changeKey"+n,this.object),this.currentValues[n]=this.object[n],i=!0),u.prototype.on.call(this,"changeKey"+n,e,t),i&&Object.defineProperty(this.object,n,{set:function(e){var t=r.currentValues[n];(r.currentValues[n]=e)!==t&&r.fire("changeKey"+n,e,t,n,r.object)},get:function(){return r.currentValues[n]}})},c.prototype.assign=function(){if("function"==typeof Object.assign)return Object.assign.apply(null,[this.object].concat(Array.prototype.slice.call(arguments)));if(null==this.object)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(this.object),t=0;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.prototype.clone=function(){return JSON.parse(JSON.stringify(this.object))},c.prototype.mergeUnique=function(i){var o=this;return null!=i&&Object.keys(this.object).forEach(function(e){var t,n,r;i.hasOwnProperty(e)&&(o.object[e]=(r=o.object[e],t=typeof r,n=i[e],"boolean"===t?!!n:"number"===t?Number(n):"string"===t?String(n):n))}),this.object},c.prototype.toArray=function(){var t=this;return Object.keys(this.object).map(function(e){return t.object[e]})},c.prototype.toMapArray=function(){var t=this;return Object.keys(this.object).map(function(e){return[e,t.object[e]]})},c.prototype.forEach=function(t,n){var r=this;return n||(n=this.object),Object.keys(this.object).forEach(function(e){t.call(n,r.object[e],e,r.object)},n)},c.prototype.map=function(t,n){var r=this;n||(n=this.object);var i={};return Object.keys(this.object).forEach(function(e){i[e]=t.call(n,r.object[e],e,r.object)},n),i};var p=[59],v={headersIncluded:!1,headerPrefix:"column_",spaceAllowedBetweenDelimiterAndQuote:!0,treatConsecutiveDelmitersAsOne:!1,removeLeadingEmptyRows:!0,removeTrailingEmptyRows:!0,removeInnerEmptyRows:!1,trimValues:!0,emptyValuesAreNull:!0},d={incorrectTrailingQuote:"Unexpected token found after closing Quote for value",incorrectQuote:"Unexpected Quote found inside value"};function y(e,t){return l(e).mergeUnique(t)}function g(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(e.charCodeAt(n));return t}function b(e){return new RegExp('["'+e.map(String.fromCharCode).join("")+"\n\r]")}function j(e,d,y,g,b,j){var m=34,A=10,_=13,E=32,O={},w={},C={};return j=void 0===j?1/0:Number(j),function(s){var e,o=[],t=[],n=[],u=!0,c={},a=s.length,f=b||0,r=0,h=a<=0,l=!1,p=[];function v(e){c={id:e,lineIndex:r,characterIndex:f},u=!1}function i(){var e,t,n,r,i;if(h)return O;if(l)return l=!1,w;function o(){return(i=s.charCodeAt(f++))===A?l=!0:i===_&&(l=!0,s.charCodeAt(f)===A&&++f),l}for(e=f,n=!1,r=s.charCodeAt(e)===m||y.spaceAllowedBetweenDelimiterAndQuote;f<a;){if(n){if(r){for(;f<a&&s.charCodeAt(f++)!==m||s.charCodeAt(f++)===m;);if(t=f-=2,y.spaceAllowedBetweenDelimiterAndQuote)for(;f<a&&s.charCodeAt(++f)===E;);else f++;return o()||(h=a<=f)||~g.indexOf(i)?s.slice(e,t).replace(/""/g,'"'):(v("incorrectTrailingQuote"),C)}return v("incorrectQuote"),C}if(o()||~g.indexOf(i))return s.slice(e,f-1);i===m?(n=!0,e=f):i!==E&&(r=!1)}return h=!0,s.slice(e,a)}for(;r<=j&&(e=i())!==O&&u;){for(t=[],n=[];e!==w&&e!==O&&e!==C;){if(y.trimValues&&(e=e.trim()),y.emptyValuesAreNull&&!e.length&&(e=null),t.push(e),!l&&y.treatConsecutiveDelmitersAsOne){for(;f<a&&~g.indexOf(s.charCodeAt(f++)););f--}e=i()}if(u){if(null==(n=d?d(t,r):t)||t.length&&0!==t.join("").length||p.push(r),r++,null==n)continue;o.push(n)}}return function(){for(var e=o.length-1,t=x(p).groupSequence(function(e,t){return t-e==1}),n=[],r=0,i=t.length;r<i;r++)(y.removeLeadingEmptyRows&&0===t[r][0]||y.removeInnerEmptyRows&&0!==t[r][0]&&t[r][t[r].length-1]!==e||y.removeTrailingEmptyRows&&t[r][t[r].length-1]===e)&&(n=n.concat(t[r]));return{result:o.filter(function(e,t){return!~n.indexOf(t)}),emptyRecordLines:p,error:c,validCSV:u,startIndex:b,endIndex:f}}()}(e)}e.version=function(){return t},e.id=function(e){return(arguments.length?e+"_":"")+r++},e.ready=function(e,t){t||(t=document),o?e.call(t,n):i.push([e,t])},e.template=function(e,n,r){return r=r||"",e.replace(/\${([^}]*)}/g,function(e,t){return t.split(".").reduce(function(e,t){return e.hasOwnProperty(t)?e[t]:r},n)})},e.array=x,e.EventDispatcher=s,e.object=l,e.csv=function(){var a=l(v).clone(),f=p,h=0,t=b(f);function u(e){var t,n,r,i,o,s;for(h=0;t=j(e,void 0,a,f,h,0),h=t.endIndex,1!==t.result.length&&t.validCSV;);if(t.validCSV){t.result[0]=x(t.result[0]).replaceNull(function(e,t){return a.headerPrefix+t});for(var u=0,c=t.result[0].length;u<c;u++){for(o=t.result[0][u];t.result[0].indexOf(o)<u&&-1<t.result[0].indexOf(o);)1===(i=o.split("_")).length?(n=i[0],r=-1):(r=i.pop(),s=r,!isNaN(parseFloat(s))&&isFinite(s)&&Number(r)%1==0?(r=Number(r),n=i.join("_")):(n=i.concat(r).join("_"),r=-1)),o=n+"_"+ ++r;t.result[0][u]=o}}return t}function c(e,t){return e.header=t,e.validCSV||(e.error.message=d[e.error.id]),e}function s(e){return null===e?"":t.test(e)?'"'+e.replace(/"/g,'""')+'"':e}return 1===arguments.length?"string"==typeof arguments[0]?(f=g(arguments[0]),t=b(f)):a=y(a,arguments[0]):1<arguments.length&&(f=g(arguments[0]),t=b(f),a=y(a,arguments[1])),{toArray:function(e,t,n){var r;if(a.headersIncluded){if(!(r=u(e)).validCSV)return c(r);r=r.result[0]}else r=[];return n=n||r,c(j(e,t,a,f,h),n)},toObject:function(e,n,t){var r,i,o,s;if(a.headersIncluded){if(!(i=u(e)).validCSV)return c(i);i=i.result[0]}else i=[];return o=t=t||i,s=a.headerPrefix,o=Array.isArray(o)?o:[],s=s||"field_",s=o.reduce(function(e,t){for(;t.substr(0,e.length)===e;)e+="_";return e},s),r=function(e){return e.reduce(function(e,t,n){return e[o[n]||s+n]=t,e},{})},c(j(e,n?function(e,t){return n(r(e),t)}:r,a,f,h),t)},fromObject:function(e,t){var n,r,i,o=String.fromCharCode(f[0]);return i=(t=t||[]).reduce(function(e,t,n){return e[t]=n,e},{}),n=function(e,t){var n=[];return l(e).forEach(function(e,t){i.hasOwnProperty(t)||(i[t]=Object.keys(i).length),n[i[t]]=s(e)}),n.join(t)},r=function(e){return n(e,o)},t=t||[],e.map(r),[t.map(function(e){return s(e)}).join(o)].concat(e.map(r)).join("\n")},fromArray:function(e,t){var n=String.fromCharCode(f[0]),r=function(e){return t=n,e.map(function(e){return s(e)}).join(t);var t};return[r(t=t||[])].concat(e.map(r)).join("\n")}}},Object.defineProperty(e,"__esModule",{value:!0})});